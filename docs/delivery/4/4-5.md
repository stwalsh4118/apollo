# [4-5] Mark Complete button and completion indicators

[Back to task list](./tasks.md)

## Description

Add a "Mark Complete" button at the bottom of the lesson view that updates lesson status via the progress API. Add completion indicators (checkmarks) next to lesson items in the module sidebar.

## Status History

| Timestamp | Event Type | From Status | To Status | Details | User |
|-----------|------------|-------------|-----------|---------|------|
| 2026-02-19 05:11:17 | Created | N/A | Proposed | Task file created | AI_Agent |
| 2026-02-19 05:28:26 | Status Change | Proposed | InProgress | Started implementation | AI_Agent |
| 2026-02-19 05:33:16 | Status Change | InProgress | Review | Implementation complete, internal AI review passed after fix | AI_Agent |
| 2026-02-19 06:23:56 | Status Change | Review | Done | Task completed and verified | AI_Agent |

## Requirements

1. **Mark Complete button** in `LessonContent`:
   - Rendered at the bottom of the lesson article
   - Uses `useUpdateLessonProgress` mutation to set status to `completed`
   - Shows visual confirmation on success (e.g., button changes to "Completed" with checkmark, disabled state)
   - If already completed, show "Completed" state instead of active button
   - Button should be prominent but not intrusive (per UX requirements)

2. **Completion indicators** in `LessonItem`:
   - Show a checkmark icon for completed lessons (replacing the current dot indicator)
   - Show a filled/hollow circle for in_progress/not_started respectively
   - Requires progress data to flow from `CourseViewPage` → `ModuleSidebar` → `ModuleItem` → `LessonItem`

3. **Data flow**:
   - `CourseViewPage` fetches topic progress via `useTopicProgress(topicId)` and passes a progress map down to the sidebar
   - The progress map is keyed by `lesson_id` → `status`

## Implementation Plan

1. Update `CourseViewPage` to fetch topic progress and build a `Map<string, string>` (lessonId → status)
2. Thread progress map through `ModuleSidebar` → `ModuleItem` → `LessonItem` props
3. Update `LessonItem` to show checkmark/circle based on progress status
4. Add Mark Complete button to `LessonContent` using the mutation hook
5. Handle optimistic UI or refetch on mutation success

## Test Plan

- Mark Complete button renders at bottom of lesson
- Clicking Mark Complete calls PUT with correct lesson ID and `completed` status
- Button transitions to disabled "Completed" state after success
- Already-completed lessons show "Completed" state on load
- Sidebar lesson items show checkmark for completed lessons
- Sidebar lesson items show circle for not_started/in_progress lessons
- Browser verification with Playwright

## Verification

_To be completed during implementation._

## Files Modified

- `web/src/components/LessonContent.tsx`
- `web/src/components/LessonItem.tsx`
- `web/src/components/ModuleItem.tsx`
- `web/src/components/ModuleSidebar.tsx`
- `web/src/pages/CourseViewPage.tsx`
